{% extends "base.html" %}

{% block content %}
<!-- Hero Section: Promo Banner -->
<section class="hero-section d-flex align-items-center justify-content-center text-center position-relative" style="min-height: 70vh; background: linear-gradient(135deg, #181c1f 0%, #232526 100%); overflow: hidden;">
    <div class="hero-overlay position-absolute top-0 start-0 w-100 h-100" style="background: rgba(0,0,0,0.7);"></div>
    <div class="container position-relative z-2 py-5">
        <h1 class="display-2 fw-bold text-white mb-3">Toko Komputer Gloria</h1>
        <p class="lead text-light mb-4">Temukan berbagai produk komputer, laptop, aksesoris, dan kebutuhan IT terbaik untuk Anda.<br>Harga bersaing, stok terjamin, layanan profesional.</p>
        <a href="{{ url_for('main.products') }}" class="btn btn-primary btn-lg me-2"><i class="bi bi-cart4 me-2"></i>Belanja Sekarang</a>
    </div>
    <canvas id="bgParticles" class="position-absolute top-0 start-0 w-100 h-100" style="z-index:1; pointer-events:none;"></canvas>
</section>

<!-- Product Highlights -->
<section class="container py-5">
    <div class="row text-center mb-4">
        <h2 class="fw-bold text-white mb-3">Produk Unggulan</h2>
        <p class="text-muted">Pilihan terbaik untuk kebutuhan komputer & teknologi Anda</p>
    </div>
    <div class="row g-4 justify-content-center">
        {% for product in products[:6] %}
        <div class="col-md-4 col-lg-3">
            <div class="card bg-dark border-0 shadow h-100 text-light product-card">
                {% if product.photo %}
                <img src="{{ url_for('static', filename='uploads/' ~ product.photo) }}" class="card-img-top" alt="{{ product.product_name }}" style="object-fit:cover; height:180px;">
                {% else %}
                <img src="{{ url_for('static', filename='uploads/no-image.png') }}" class="card-img-top" alt="No Image" style="object-fit:cover; height:180px;">
                {% endif %}
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">{{ product.product_name }}</h5>
                    <p class="card-text mb-2">Kategori: <span class="badge bg-secondary">{{ product.category or 'Lainnya' }}</span></p>
                    <p class="card-text">Harga: <span class="text-warning">Rp{{ '{:,.0f}'.format(product.selling_price) }}</span></p>
                    <a href="{{ url_for('main.products') }}" class="btn btn-outline-primary btn-sm mt-2">Lihat Detail</a>
                </div>
            </div>
        </div>
        {% else %}
        <div class="col-12 text-center text-muted">Belum ada produk di inventaris.</div>
        {% endfor %}
    </div>
</section>

<!-- Category/Service Section -->
<section class="container py-5">
    <div class="row text-center mb-4">
        <h2 class="fw-bold text-white mb-3">Kategori Produk & Layanan</h2>
        <p class="text-muted">Kami menyediakan berbagai kategori produk dan layanan untuk kebutuhan Anda</p>
    </div>
    <div class="row g-4 justify-content-center">
        <div class="col-md-3">
            <div class="card bg-dark border-0 shadow h-100 text-light">
                <div class="card-body text-center">
                    <i class="bi bi-laptop display-4 mb-3 text-primary"></i>
                    <h6 class="fw-bold">Laptop & Notebook</h6>
                    <p class="small">Berbagai pilihan laptop untuk kebutuhan kerja, sekolah, dan gaming.</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-dark border-0 shadow h-100 text-light">
                <div class="card-body text-center">
                    <i class="bi bi-cpu display-4 mb-3 text-success"></i>
                    <h6 class="fw-bold">Komponen PC</h6>
                    <p class="small">Processor, RAM, SSD, motherboard, dan komponen lainnya.</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-dark border-0 shadow h-100 text-light">
                <div class="card-body text-center">
                    <i class="bi bi-keyboard display-4 mb-3 text-warning"></i>
                    <h6 class="fw-bold">Aksesoris & Periferal</h6>
                    <p class="small">Keyboard, mouse, monitor, printer, dan aksesoris lainnya.</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-dark border-0 shadow h-100 text-light">
                <div class="card-body text-center">
                    <i class="bi bi-tools display-4 mb-3 text-info"></i>
                    <h6 class="fw-bold">Layanan Servis</h6>
                    <p class="small">Perbaikan, upgrade, dan konsultasi IT untuk semua kebutuhan Anda.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Call to Action -->
<section class="container py-5 text-center">
    <div class="bg-dark rounded-4 p-5 shadow-lg">
        <h3 class="fw-bold text-white mb-3">Butuh bantuan memilih produk atau konsultasi IT?</h3>
        <p class="text-muted mb-4">Hubungi tim kami untuk mendapatkan rekomendasi terbaik dan penawaran spesial.</p>
        <a href="mailto:info@gloriakomputer.com" class="btn btn-success btn-lg"><i class="bi bi-whatsapp me-2"></i>Hubungi Kami</a>
    </div>
</section>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
// Simple animated dots background
const canvas = document.getElementById('bgParticles');
if (canvas) {
    const ctx = canvas.getContext('2d');
    let w, h, particles = [];
    function resize() {
        w = canvas.width = window.innerWidth;
        h = canvas.height = 400;
    }
    window.addEventListener('resize', resize);
    resize();
    for (let i = 0; i < 60; i++) {
        particles.push({
            x: Math.random() * w,
            y: Math.random() * h,
            r: Math.random() * 2 + 1,
            dx: (Math.random() - 0.5) * 0.5,
            dy: (Math.random() - 0.5) * 0.5
        });
    }
    function draw() {
        ctx.clearRect(0, 0, w, h);
        ctx.globalAlpha = 0.7;
        for (const p of particles) {
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.r, 0, 2 * Math.PI);
            ctx.fillStyle = '#fff';
            ctx.fill();
            p.x += p.dx;
            p.y += p.dy;
            if (p.x < 0 || p.x > w) p.dx *= -1;
            if (p.y < 0 || p.y > h) p.dy *= -1;
        }
        requestAnimationFrame(draw);
    }
    draw();
}

// Cart logic
function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem('cart') || '[]');
    document.getElementById('cartCount').textContent = cart.length;
}

document.addEventListener('DOMContentLoaded', function() {
    updateCartCount();
    document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const name = this.dataset.product;
            const price = parseInt(this.dataset.price);
            const category = this.dataset.category;
            let cart = JSON.parse(localStorage.getItem('cart') || '[]');
            // Jika produk sudah ada, tambah qty
            const idx = cart.findIndex(item => item.name === name);
            if(idx !== -1) {
                cart[idx].qty += 1;
            } else {
                cart.push({name, price, category, qty: 1});
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
        });
    });
});
</script>
{% endblock %}
